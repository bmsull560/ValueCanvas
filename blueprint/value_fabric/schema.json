{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/value_fabric.schema.json",
  "title": "Value Fabric Schema",
  "description": "Unified data schema for the Value Fabric, defining the core objects used by all agents.",
  "type": "object",
  "definitions": {
    "BusinessObjective": {
      "type": "object",
      "required": ["id", "name", "description"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "name": {"type": "string"},
        "description": {"type": "string"},
        "priority": {"type": "integer", "minimum": 1, "maximum": 5},
        "owner": {"type": "string"}
      }
    },
    "Capability": {
      "type": "object",
      "required": ["id", "name"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "name": {"type": "string"},
        "description": {"type": "string"},
        "tags": {"type": "array", "items": {"type": "string"}}
      }
    },
    "UseCase": {
      "type": "object",
      "required": ["id", "name", "capabilityIds"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "name": {"type": "string"},
        "description": {"type": "string"},
        "capabilityIds": {"type": "array", "items": {"type": "string"}},
        "kpiIds": {"type": "array", "items": {"type": "string"}}
      }
    },
    "KPI": {
      "type": "object",
      "required": ["id", "name", "measurement"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "name": {"type": "string"},
        "description": {"type": "string"},
        "measurement": {"type": "string", "enum": ["percentage", "currency", "time", "count"]},
        "targetDirection": {"type": "string", "enum": ["increase", "decrease"]}
      }
    },
    "FinancialMetric": {
      "type": "object",
      "required": ["id", "name", "type"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "name": {"type": "string"},
        "type": {"type": "string", "enum": ["revenue", "cost", "risk"]},
        "currency": {"type": "string", "pattern": "^[A-Z]{3}$"},
        "unit": {"type": "string"}
      }
    },
    "ValueTree": {
      "type": "object",
      "required": ["id", "useCaseId", "nodes"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "useCaseId": {"type": "string", "format": "uuid"},
        "nodes": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["nodeId", "label", "type"],
            "properties": {
              "nodeId": {"type": "string"},
              "label": {"type": "string"},
              "type": {"type": "string", "enum": ["capability", "outcome", "kpi", "financialMetric"]},
              "linkIds": {"type": "array", "items": {"type": "string"}}
            }
          }
        }
      }
    },
    "ROIModel": {
      "type": "object",
      "required": ["id", "valueTreeId", "assumptions", "calculations"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "valueTreeId": {"type": "string", "format": "uuid"},
        "assumptions": {"type": "array", "items": {"type": "string"}},
        "calculations": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["name", "formula"],
            "properties": {
              "name": {"type": "string"},
              "formula": {"type": "string"},
              "description": {"type": "string"}
            }
          }
        },
        "version": {"type": "string"}
      }
    },
    "Benchmark": {
      "type": "object",
      "required": ["id", "kpiId", "industry", "value"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "kpiId": {"type": "string", "format": "uuid"},
        "industry": {"type": "string"},
        "region": {"type": "string"},
        "value": {"type": "number"},
        "unit": {"type": "string"}
      }
    },
    "ValueCommit": {
      "type": "object",
      "required": ["id", "valueTreeId", "kpiTargets"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "valueTreeId": {"type": "string", "format": "uuid"},
        "kpiTargets": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["kpiId", "targetValue", "unit"],
            "properties": {
              "kpiId": {"type": "string", "format": "uuid"},
              "targetValue": {"type": "number"},
              "unit": {"type": "string"},
              "deadline": {"type": "string", "format": "date"}
            }
          }
        },
        "committedBy": {"type": "string"},
        "dateCommitted": {"type": "string", "format": "date-time"}
      }
    },
    "TelemetryEvent": {
      "type": "object",
      "required": ["id", "kpiId", "timestamp", "value"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "kpiId": {"type": "string", "format": "uuid"},
        "timestamp": {"type": "string", "format": "date-time"},
        "value": {"type": "number"},
        "metadata": {"type": "object"}
      }
    },
    "RealizationReport": {
      "type": "object",
      "required": ["id", "valueCommitId", "results"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "valueCommitId": {"type": "string", "format": "uuid"},
        "generatedAt": {"type": "string", "format": "date-time"},
        "results": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["kpiId", "actualValue", "targetValue", "unit"],
            "properties": {
              "kpiId": {"type": "string", "format": "uuid"},
              "actualValue": {"type": "number"},
              "targetValue": {"type": "number"},
              "unit": {"type": "string"},
              "variance": {"type": "number"}
            }
          }
        }
      }
    },
    "ExpansionModel": {
      "type": "object",
      "required": ["id", "valueTreeId", "proposedImprovements"],
      "properties": {
        "id": {"type": "string", "format": "uuid"},
        "valueTreeId": {"type": "string", "format": "uuid"},
        "proposedImprovements": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["kpiId", "incrementalValue", "unit"],
            "properties": {
              "kpiId": {"type": "string", "format": "uuid"},
              "incrementalValue": {"type": "number"},
              "unit": {"type": "string"},
              "confidence": {"type": "number", "minimum": 0, "maximum": 1}
            }
          }
        },
        "executiveSummary": {"type": "string"}
      }
    }
  },
  "properties": {
    "businessObjectives": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/BusinessObjective"}
    },
    "capabilities": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/Capability"}
    },
    "useCases": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/UseCase"}
    },
    "kpis": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/KPI"}
    },
    "financialMetrics": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/FinancialMetric"}
    },
    "valueTrees": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/ValueTree"}
    },
    "roiModels": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/ROIModel"}
    },
    "benchmarks": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/Benchmark"}
    },
    "valueCommits": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/ValueCommit"}
    },
    "telemetryEvents": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/TelemetryEvent"}
    },
    "realizationReports": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/RealizationReport"}
    },
    "expansionModels": {
      "type": "array",
      "items": {"$ref": "#\/definitions\/ExpansionModel"}
    }
  },
  "additionalProperties": false
}